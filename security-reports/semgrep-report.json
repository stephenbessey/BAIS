{"version":"1.137.1","results":[{"check_id":"python.jwt.security.unverified-jwt-decode.unverified-jwt-decode","path":"backend/production/core/a2a_authentication.py","start":{"line":86,"col":81,"offset":2783},"end":{"line":86,"col":86,"offset":2788},"extra":{"message":"Detected JWT token decoded with 'verify=False'. This bypasses any integrity checks for the token which means the token could be tampered with by malicious actors. Ensure that the JWT token is verified.","fix":"True","metadata":{"owasp":["A02:2017 - Broken Authentication","A07:2021 - Identification and Authentication Failures"],"cwe":["CWE-287: Improper Authentication"],"references":["https://github.com/we45/Vulnerable-Flask-App/blob/752ee16087c0bfb79073f68802d907569a1f0df7/app/app.py#L96"],"category":"security","technology":["jwt"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["audit"],"likelihood":"MEDIUM","impact":"MEDIUM","confidence":"MEDIUM","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Improper Authentication"],"source":"https://semgrep.dev/r/python.jwt.security.unverified-jwt-decode.unverified-jwt-decode","shortlink":"https://sg.run/6nyB"},"severity":"ERROR","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"python.flask.security.xss.audit.direct-use-of-jinja2.direct-use-of-jinja2","path":"backend/production/core/mcp_prompts.py","start":{"line":471,"col":16,"offset":18316},"end":{"line":471,"col":42,"offset":18342},"extra":{"message":"Detected direct use of jinja2. If not done properly, this may bypass HTML escaping which opens up the application to cross-site scripting (XSS) vulnerabilities. Prefer using the Flask method 'render_template()' and templates with a '.html' extension in order to prevent XSS.","metadata":{"cwe":["CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"],"owasp":["A07:2017 - Cross-Site Scripting (XSS)","A03:2021 - Injection"],"references":["https://jinja.palletsprojects.com/en/2.11.x/api/#basics"],"category":"security","technology":["flask"],"cwe2022-top25":true,"cwe2021-top25":true,"subcategory":["audit"],"likelihood":"LOW","impact":"MEDIUM","confidence":"LOW","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Cross-Site-Scripting (XSS)"],"source":"https://semgrep.dev/r/python.flask.security.xss.audit.direct-use-of-jinja2.direct-use-of-jinja2","shortlink":"https://sg.run/RoKe"},"severity":"WARNING","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}}],"errors":[],"paths":{"scanned":["backend/production/__init__.py","backend/production/api/__init__.py","backend/production/api/middleware/__init__.py","backend/production/api/middleware/ap2_auth.py","backend/production/api/v1/__init__.py","backend/production/api/v1/a2a/discovery.py","backend/production/api/v1/a2a/sse_router.py","backend/production/api/v1/a2a/tasks.py","backend/production/api/v1/errors/unified_error_router.py","backend/production/api/v1/health_router.py","backend/production/api/v1/mcp/prompts_router.py","backend/production/api/v1/mcp/sse_router.py","backend/production/api/v1/mcp/subscription_router.py","backend/production/api/v1/monitoring/circuit_breaker_router.py","backend/production/api/v1/monitoring/dashboard_router.py","backend/production/api/v1/monitoring/performance_router.py","backend/production/api/v1/payments/__init__.py","backend/production/api/v1/payments/mandate_router.py","backend/production/api/v1/payments/transaction_router.py","backend/production/api/v1/payments/webhook_router.py","backend/production/api_models.py","backend/production/config/__init__.py","backend/production/config/ap2_settings.py","backend/production/config/logging_config.py","backend/production/config/mcp_settings.py","backend/production/config/protocol_settings.py","backend/production/config/settings.py","backend/production/core/__init__.py","backend/production/core/a2a_agent_card_generator.py","backend/production/core/a2a_agent_registry.py","backend/production/core/a2a_authentication.py","backend/production/core/a2a_dependency_injection.py","backend/production/core/a2a_exceptions.py","backend/production/core/a2a_integration.py","backend/production/core/a2a_processor_manager.py","backend/production/core/a2a_registry_network.py","backend/production/core/a2a_streaming_tasks.py","backend/production/core/a2a_task_processor.py","backend/production/core/ap2_exceptions.py","backend/production/core/bais_schema_validator.py","backend/production/core/business_command_repository.py","backend/production/core/business_query_repository.py","backend/production/core/circuit_breaker.py","backend/production/core/comprehensive_error_handler.py","backend/production/core/connection_pool_manager.py","backend/production/core/constants.py","backend/production/core/database_models.py","backend/production/core/distributed_tracing.py","backend/production/core/exceptions.py","backend/production/core/mcp_audit_logger.py","backend/production/core/mcp_authentication_service.py","backend/production/core/mcp_error_handler.py","backend/production/core/mcp_graceful_shutdown.py","backend/production/core/mcp_input_validation.py","backend/production/core/mcp_monitoring.py","backend/production/core/mcp_prompts.py","backend/production/core/mcp_route_handlers.py","backend/production/core/mcp_server_generator.py","backend/production/core/mcp_sse_transport.py","backend/production/core/mcp_subscription_manager.py","backend/production/core/oauth2_authorization_service.py","backend/production/core/oauth2_client_manager.py","backend/production/core/oauth2_security.py","backend/production/core/oauth2_token_service.py","backend/production/core/parameter_objects.py","backend/production/core/payments/__init__.py","backend/production/core/payments/ap2_client.py","backend/production/core/payments/ap2_mandate_validator.py","backend/production/core/payments/ap2_payment_workflow.py","backend/production/core/payments/business_validator.py","backend/production/core/payments/cryptographic_mandate_validator.py","backend/production/core/payments/currency_manager.py","backend/production/core/payments/mandate_manager.py","backend/production/core/payments/models.py","backend/production/core/payments/payment_coordinator.py","backend/production/core/payments/payment_event_publisher.py","backend/production/core/payments/verifiable_credential.py","backend/production/core/protocol_configurations.py","backend/production/core/protocol_error_handler.py","backend/production/core/secure_logging.py","backend/production/core/unified_error_handler.py","backend/production/core/workflow_event_bus.py","backend/production/core/workflow_state_manager.py","backend/production/main.py","backend/production/middleware/security_middleware.py","backend/production/monitoring/health.py","backend/production/monitoring/health_checks.py","backend/production/monitoring/metrics.py","backend/production/routes.py","backend/production/services/__init__.py","backend/production/services/agent_service.py","backend/production/services/business-registry.json","backend/production/services/business_registration_orchestrator.py","backend/production/services/business_registration_service.py","backend/production/services/business_repository.py","backend/production/services/business_server_factory.py","backend/production/services/business_service.py","backend/production/services/business_validator.py","backend/production/services/errors.js","backend/production/services/prompt-service.js","backend/production/utils/schema_factory.py"]},"time":{"rules":[],"rules_parse_time":0.5547380447387695,"profiling_times":{"config_time":0.9552240371704102,"core_time":2.01005220413208,"ignores_time":0.0004680156707763672,"total_time":2.96608304977417},"parsing_time":{"total_time":0.0,"per_file_time":{"mean":0.0,"std_dev":0.0},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_files":[]},"scanning_time":{"total_time":9.498639822006226,"per_file_time":{"mean":0.03134864627724828,"std_dev":0.0033872231118076642},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_files":[]},"matching_time":{"total_time":0.0,"per_file_and_rule_time":{"mean":0.0,"std_dev":0.0},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_rules_on_files":[]},"tainting_time":{"total_time":0.0,"per_def_and_rule_time":{"mean":0.0,"std_dev":0.0},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_rules_on_defs":[]},"fixpoint_timeouts":[],"prefiltering":{"project_level_time":0.0,"file_level_time":0.0,"rules_with_project_prefilters_ratio":0.0,"rules_with_file_prefilters_ratio":0.9896128097177169,"rules_selected_ratio":0.060321623300434814,"rules_matched_ratio":0.060321623300434814},"targets":[],"total_bytes":0,"max_memory_bytes":1138345216},"engine_requested":"OSS","skipped_rules":[]}